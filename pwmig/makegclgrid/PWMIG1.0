# extension tables to css3.0 for p to s conversion software by 
# Pavlis and students.  This is an extension and should always
# be used with a db descriptor that defines the concatenation 
# of this file to css3.0
Include css3.0
Attribute gridname
	String(8)
	Format ( "%-8s" )
	Null ( "-" )
	Description ( "Name of a geographical curvilinear grid" )
	Detail {
		We use a convenient name to describe a given 
		curvlinear grid object definition.  
	}
	;

Attribute radius
	Real (10)
	Format ( "%10.3f" )
	Null ( "-1.0" )
	Range ( "radius > 0.0" )
	Units ( "Kilometers" )
	Description ( "radius of a spherical surface" )
	Detail {
		The earth is approximately spherical and large scale
		imaging requires spherical shaped objects.  Radius is
		a base parameter to describe location of a point in
		the earth when spherical coordinates are used.
	}
	;

Attribute dx1nom
	Real (7)
        Format ( "%7.2lf" )
        Null ( "-1.00" )
	Range ( "dx1nom > 0.0" )
	Units ( "Kilometers" )
	Description ( "Nominal grid spacing in x1 direction" )
	Detail {
		This and two related attributes define the nominal 
		grid spacing of a geographical curvilinear grid coordinate
		definition file.  Because the mapping is not required to
		be uniform this is only a nominal value, not the actual
		grid spacing. 
	}
	;

Attribute dx2nom
	Real (7)
        Format ( "%7.2lf" )
        Null ( "-1.00" )
	Range ( "dx2nom > 0.0" )
	Units ( "Kilometers" )
	Description ( "Nominal grid spacing in x2 direction" )
	Detail {
		This and two related attributes define the nominal 
		grid spacing of a geographical curvilinear grid coordinate
		definition file.  Because the mapping is not required to
		be uniform this is only a nominal value, not the actual
		grid spacing. 
	}
	;

Attribute dx3nom
	Real (7)
        Format ( "%7.2lf" )
        Null ( "-1.00" )
	Range ( "dx3nom > 0.0" )
	Units ( "Kilometers" )
	Description ( "Nominal grid spacing in x3 direction" )
	Detail {
		This and two related attributes define the nominal 
		grid spacing of a geographical curvilinear grid coordinate
		definition file.  Because the mapping is not required to
		be uniform this is only a nominal value, not the actual
		grid spacing. 
	}
	;

Attribute azimuth_y
        Real (7)
        Format ( "%7.2lf" )
        Null ( "-1.00" )
        Range ( "azimuth_y >= 0.0 && azimuth_y < 360.0" )
        Units ( "Degrees" )
        Description ( "Azimuth of y axis at coordinate origin" )
        Detail {
		In geographical curvilinear coordinates this is the
		trajectory of the y Cartesian axis at the origin of
		the coordinate system.  The x axis is always assumed
		to be 90 degrees away and z is assumed up.  This
		uniquely defines the origin and orientation of
		the Cartesian system when combined with the 
		origin definition parameters.
        }
        ;

Attribute dimensions
	Integer (3)
	Format ( "%3d" )
	Null ("0")
	Range ( "dimensions > 0" )
	Description ("Number of dimensions" )
	Detail {
		Graphical objects multidimensional.  This parameter
		defines the number of dimensions in the object.  
		It is normally 2 or 3.
	}
	;

Attribute n1
	Integer (4)
	Format ( "%4d")
	Null ("-1")
	Range ( "n1 >= 0" )
	Description ( "Number of grid cells in dimension 1" )
	Detail {
		Geographical curvilinear grids are defined by 
		3d arrays with n1 points for dimension 1 
		n2 points for dimension 2 and n3 points for dimension 3.
	}
	;

Attribute n2
	Integer (4)
	Format ( "%4d")
	Null ("-1")
	Range ( "n2 >= 0" )
	Description ( "Number of grid cells in dimension 2" )
	Detail {
		Geographical curvilinear grids are defined by 
		3d arrays with n1 points for dimension 1 
		n2 points for dimension 2 and n3 points for dimension 3.
	}
	;

Attribute n3
	Integer (4)
	Format ( "%4d")
	Null ("-1")
	Range ( "n3 >= 0" )
	Description ( "Number of grid cells in dimension 3" )
	Detail {
		Geographical curvilinear grids are defined by 
		3d arrays with n1 points for dimension 1 
		n2 points for dimension 2 and n3 points for dimension 3.
	}
	;

Attribute xlow
	Real (10)
        Format ( "%10.3lf" )
	Units ( "Kilometers" )
	Description ( "minimum grid extent in the x direction" )
	Detail {
		Geographic curvilinear grids define a mapping
		of ordered groups of points onto Cartesian and/or 
		geographical coordinaes.  xlow, xhigh, ylow, yhigh,
		and zlow, zhigh define a bounding box for the 
		fully defined grid in the Cartesian system.  
		These are useful to quickly reject points outside the grid.
	}
	;

Attribute xhigh
	Real (10)
        Format ( "%10.3lf" )
	Units ( "Kilometers" )
	Description ( "maximum grid extent in the x direction" )
	Detail {
		Geographic curvilinear grids define a mapping
		of ordered groups of points onto Cartesian and/or 
		geographical coordinaes.  xlow, xhigh, ylow, yhigh,
		and zlow, zhigh define a bounding box for the 
		fully defined grid in the Cartesian system.  
		These are useful to quickly reject points outside the grid.
	}
	;

Attribute ylow
	Real (10)
        Format ( "%10.3lf" )
	Units ( "Kilometers" )
	Description ( "minimum grid extent in the y direction" )
	Detail {
		Geographic curvilinear grids define a mapping
		of ordered groups of points onto Cartesian and/or 
		geographical coordinaes.  xlow, xhigh, ylow, yhigh,
		and zlow, zhigh define a bounding box for the 
		fully defined grid in the Cartesian system.  
		These are useful to quickly reject points outside the grid.
	}
	;

Attribute yhigh
	Real (10)
        Format ( "%10.3lf" )
	Units ( "Kilometers" )
	Description ( "maximum grid extent in the y direction" )
	Detail {
		Geographic curvilinear grids define a mapping
		of ordered groups of points onto Cartesian and/or 
		geographical coordinaes.  xlow, xhigh, ylow, yhigh,
		and zlow, zhigh define a bounding box for the 
		fully defined grid in the Cartesian system.  
		These are useful to quickly reject points outside the grid.
	}
	;

Attribute zlow
	Real (10)
        Format ( "%10.3lf" )
	Units ( "Kilometers" )
	Description ( "minimum grid extent in the z direction" )
	Detail {
		Geographic curvilinear grids define a mapping
		of ordered groups of points onto Cartesian and/or 
		geographical coordinaes.  xlow, xhigh, ylow, yhigh,
		and zlow, zhigh define a bounding box for the 
		fully defined grid in the Cartesian system.  
		These are useful to quickly reject points outside the grid.
	}
	;

Attribute zhigh
	Real (10)
        Format ( "%10.3lf" )
	Units ( "Kilometers" )
	Description ( "maximum grid extent in the z direction" )
	Detail {
		Geographic curvilinear grids define a mapping
		of ordered groups of points onto Cartesian and/or 
		geographical coordinaes.  xlow, xhigh, ylow, yhigh,
		and zlow, zhigh define a bounding box for the 
		fully defined grid in the Cartesian system.  
		These are useful to quickly reject points outside the grid.
	}
	;

Attribute i0
        Integer (4)
        Format ( "%4d")
        Null ("-1")
        Range ( "i0 >= 0" )
        Description ( "index for dimension 1 of origin point" )
        Detail {
                Geographical curvilinear grids are defined by
                3d arrays with n1 points for dimension 1
                n2 points for dimension 2 and n3 points for dimension 3.
		i0, j0, and k0 define the location of the origin
		of the Cartesian coordinate system used in the mapping
		within the grid.  That is, a quanity like f[i0][j0][k0] 
		is at the origin.
        }
        ;

Attribute j0
        Integer (4)
        Format ( "%4d")
        Null ("-1")
        Range ( "j0 >= 0" )
        Description ( "index for dimension 2 of origin point" )
        Detail {
                Geographical curvilinear grids are defined by
                3d arrays with n1 points for dimension 1
                n2 points for dimension 2 and n3 points for dimension 3.
		i0, j0, and k0 define the location of the origin
		of the Cartesian coordinate system used in the mapping
		within the grid.  That is, a quanity like f[i0][j0][k0] 
		is at the origin.
        }
        ;

Attribute k0
        Integer (4)
        Format ( "%4d")
        Null ("-1")
        Range ( "i0 >= 0" )
        Description ( "index for dimension 3 of origin point" )
        Detail {
                Geographical curvilinear grids are defined by
                3d arrays with n1 points for dimension 1
                n2 points for dimension 2 and n3 points for dimension 3.
		i0, j0, and k0 define the location of the origin
		of the Cartesian coordinate system used in the mapping
		within the grid.  That is, a quanity like f[i0][j0][k0] 
		is at the origin.
        }
        ;

Attribute cdefined
	String (1)
        Format ( "%-1s" )
        Null ( "-" )
        Range ( "cdefined =~ /d|n/" )
        Description ( " Cartesian mapping = defining, non-defining" )
        Detail {
		Geographical curvilinear coordinates define mappings from
		3d arrays to a Cartesian and/or geographical coordinate
		system.  This parameter allows the option of turning
		off the Cartesian mapping and leaving it undefined.
		Be warned this may or may not be allowed in an 
		implementation that uses this. i.e. the "or" is
		not necessary a good thing.
	}
	;

Attribute geodefined
	String (1)
        Format ( "%-1s" )
        Null ( "-" )
        Range ( "geodefined =~ /d|n/" )
        Description ( " Cartesian mapping = defining, non-defining" )
        Detail {
		Geographical curvilinear coordinates define mappings from
		3d arrays to a Cartesian and/or geographical coordinate
		system.  This parameter allows the option of turning
		off the Geographical mapping and leaving it undefined.
		Be warned this may or may not be allowed in an 
		implementation that uses this. i.e. the "or" is
		not necessary a good thing.
	}
	;

Attribute pwfid
        Integer (8)
        Format ( "%8d" )
        Null ( "-1" )
        Range ( "wfid > 0" )
        Description ( "processed waveform id" )
        Detail {
		Comparable to wfid used in wfdisc, but this integer
		key is the primary index of the core processing waveform
		table and is used for association and joining of 
		ancillary tables created by all processing algorithms
		that use this schema.  
        }
        ;


Attribute ix1
	Integer (4)
	Format ( "%4d")
	Null ("-1")
	Range ( "ix1 >= 0" )
	Description ( "Index position of pseudostation point in dimension 1" )
	Detail {
		Pseudostation grids are cast here as 2d geographic 
		curvilinear coordinate grids.  ix1 and ix2 provide the 
		index that when combined with gridname allow a fast lookup
		of the coordinates of a point in space.
	}
	;

Attribute ix2
	Integer (4)
	Format ( "%4d")
	Null ("-1")
	Range ( "ix2 >= 0" )
	Description ( "Index position of pseudostation point in dimension 2" )
	Detail {
		Pseudostation grids are cast here as 2d geographic 
		curvilinear coordinate grids.  ix1 and ix2 provide the 
		index that when combined with gridname allow a fast lookup
		of the coordinates of a point in space.
	}
	;
Attribute t0
	Time (17)
	Format ( "%17.5lf" )
	Units ( "Seconds" )
	Description ( "Relative time of the start of a trace" )
	Detail {
		Absolute time is not needed in many processing algorithms
		but relative time shifts are often useful.  This attribute
		should be used to define the relative start time of a
		seismogram in a gather.  I can be thought of as a static
		correction applied after the gather was formed and indexed
		in the database.
	}
	;

Attribute joinlevel
	Integer (4)
	Format ( "%4d")
	Null ("-1")
	Range ( "joinlevel > 0" )
	Description ( "defines join order for auxiliary tables" )
	Detail {
		This attribute is used to define the sequencing of 
		multiple tables joined to a core processed waveform
		table.  That is the list of tables to be joined
		is sorted on this field in ascending order and
		joined in sequence.
	}
	;

Attribute jkey11
	String(12)
	Format ( "%-12s" )
	Null ( "-" )
	Description ( "join key 1 table 1" )
	Detail {
		This attribute defines one of the keys used to 
		join a given table to the current view.
	}
	;

Attribute jkey21
	String(12)
	Format ( "%-12s" )
	Null ( "-" )
	Description ( "join key 2 table 1" )
	Detail {
		This attribute defines one of the keys used to 
		join a given table to the current view.
	}
	;

Attribute jkey31
	String(12)
	Format ( "%-12s" )
	Null ( "-" )
	Description ( "join key 3 table 1" )
	Detail {
		This attribute defines one of the keys used to 
		join a given table to the current view.
	}
	;

Attribute jkey12
	String(12)
	Format ( "%-12s" )
	Null ( "-" )
	Description ( "join key 1 table 2" )
	Detail {
		This attribute defines one of the keys used to 
		join a given table to the current view.
	}
	;

Attribute jkey22
	String(12)
	Format ( "%-12s" )
	Null ( "-" )
	Description ( "join key 2 table 2" )
	Detail {
		This attribute defines one of the keys used to 
		join a given table to the current view.
	}
	;

Attribute jkey32
	String(12)
	Format ( "%-12s" )
	Null ( "-" )
	Description ( "join key 3 table 2" )
	Detail {
		This attribute defines one of the keys used to 
		join a given table to the current view.
	}
	;

Attribute auxtable
	String(10)
	Format ( "%-10s" )
	Null ( "-" )
	Description ( "name of database table" )
	Detail {
		This attribute is used in the general procedure for
		joining auxiliary tables to the core waveform
		processing table.  This is the name of a related
		database table that is to be joined. 
	}
	;

Relation gclgdisk
	Fields (
		gridname dimensions 
		lat lon radius azimuth_y dx1nom dx2nom dx3nom
		n1 n2 n3 i0 j0 k0 xlow xhigh ylow yhigh zlow zhigh
		cdefined geodefined datatype dir dfile foff
	)
	Primary ( gridname dimensions )
	Description ( "Geographical curvilinear coordinate grid file information" )
	Detail {
		This relation defines parameter information for geographical
		curvilinear grid files stored on disk.  2d and 3d grids 
		are indexed with the same table allowing a surface 2d
		grid to have the same base name as a 3d extension of it. 
	}
	;

Relation wfprocess
	Fields (
		pwfid algorithm dir dfile foff datatype samprate nsamp lddate
	)
	Primary ( pwfid )
	Description ( "Core processed waveform table" )
	Detail {
		The antelope trace library is designed to work exclusively
		on data stored in memory.  Not all algorithms one can
		devise for seismic data can work in this mode even on the
		largest computers so a table is needed to store processed
		waveforms in an external database.  The intent of this
		design is that this table is the core table storing all
		intermediate trace data.  Any algorithm will almost 
		certainly create auxiliary tables that can be cross linked
		into this core table through the pwfid field.  In addition
		it would be normal to select as input only traces that 
		are the output of the algorithm field.
		Note raw waveforms can also be 
		linked by a waveform association type table if one found
		this useful.  For this reason this table is a bare 
		minimum required for indexing a single seismogram.  
	}
	;

Relation pwfjoins
	Fields (
		algorithm joinlevel auxtable jkey11 jkey12 
		jkey21 jkey22 jkey31 jkey32 lddate
	)
	Primary ( algorithm joinlevel )
	Description ( "Defines processing algorithm auxiliary tables joins" )
	Detail {
		This relation supplies a general way for a new processing
		algorithm to register it's tables and define what auxiliary
		tables need to be joined to use the output of a given 
		algorithm.  Entries for a new algorithm would only be 
		added when it was registered, so to speak, for use in 
		the processing system.  The advantage of this table is
		that it allows a general purpose module to be used to 
		create a working view needed for using the output of
		the procedure defined by the algorithm field. 
	} 
	;

Relation psdecon
	Fields (
		sta chan time evid gridname ix1 ix2 pwfid method t0
	)
	Primary ( pwfid )
	Foreign ( pwfid )
	Description ( "Auxiliary table for pseudostation deconvolved data" )
	Detail {
		Pseudostation stacking and deconvolution produce entities 
		previously commonly called receiver functions.  They are
		better viewed as deconvolved seismic traces of the 
		superimposed incident wavefield and scattered waves.  
		This table defines the location in a pseudostation 
		grid of the image point used to design the deconvolution
		operator. However, the traces indexed are original seismograms
		with a deconvolution operator for a particular image point
		applied.  Thus sta chan and time are used to provide a join
		key to the css3.0 site table.
	}
	;

# GLP note:  psdecon requires a join to site
# The site joined with sta time -- chan will be X1, X2, X3 
